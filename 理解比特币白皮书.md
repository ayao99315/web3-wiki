## 交易 (Transactions)
![[5. WIKI - 系统性知识/web3/assets/理解比特币白皮书/image.png]]

> 1. 公钥和私钥有什么区别？
- **公钥 (Public Key)**：**相当于你的银行账号或是一个公开的专属信箱地址**。你可以把这个地址告诉任何人，比如把这个地址印在你的名片上。任何人都可以通过这个地址给你转账（往你的信箱里投信），但他们无法从中取走任何东西。在图中，当所有者0想把硬币给所有者1时，他需要知道所有者1的公钥地址。
    
- **私钥 (Private Key)**：**相当于你的银行卡密码或是能打开你专属信箱的那把独一无二的钥匙**。它必须绝对保密，只有你自己知道。私钥的作用是**证明**你对你公钥地址（信箱）里的资产拥有控制权。当你需要花掉这笔钱（打开信箱取信）时，你就必须使用你的私钥。
**总结一下：公钥用来收款，私钥用来付款（授权交易）。** 它们是成对生成的，在数学上相关，但你无法通过公钥推算出私钥。

> 2. 公钥和私钥如何组合成为“签名”？

这是一个常见的误解，公钥和私钥并不是“组合”在一起，而是在一个过程中**分工合作**。这个过程叫做**数字签名**。

我们来看中间这笔交易中，“所有者1的签名”是如何产生的：

1. **意图声明**：所有者1想要发起一笔交易。这笔交易的内容可以简化为一句话：“我，所有者1，现在授权将我之前收到的那笔交易（用‘上一笔交易的哈希’来唯一标识）的控制权，转移给‘所有者2的公钥’地址。”
    
2. **生成签名**：为了证明这句话确实是所有者1本人发出的，他需要用他的**私钥**对这笔交易的内容进行一次加密运算。这个运算的结果就是那个独一无二的**“所有者1的签名”**。
    
3. **广播与验证**：所有者1将这笔交易的内容（包括上一笔交易的哈希、所有者2的公钥）和他的**签名**一起广播到网络中。
    
4. **公开验证**：网络上的任何人都可以进行验证。他们可以使用公开的**所有者1的公钥**，来对那笔交易内容和签名进行一次反向的数学运算。如果验证成功，就能证明两件事：
    - 这个签名的确是由所有者1的私钥生成的（因为只有对应的公钥才能解开它），这证明了**身份**。
    - 交易内容从被签名那一刻起，没有被任何人篡改过，这保证了**信息的完整性**。

所以，流程是：**用私钥签名（花钱），用公钥验证签名（确认是本人操作）**。

>3. 图中谁是出售者，谁是购买者？

在任何一笔交易中，**发送硬币的人是付款方（购买者），接收硬币的人是收款方（出售者）**。

我们仍然以中间的**第二笔交易**为例：
- **所有者1**：是这笔交易的发起者，他正在把硬币花出去。所以，他是**付款方/购买者**。
- **所有者2**：是这笔交易的接收者，他的公钥被指定为新的所有者地址。所以，他是**收款方/出售者**。
    
整张图连起来看就是：
- 在第一笔交易中，所有者0是购买者，所有者1是出售者。
- 在第二笔交易中，所有 t者1变成了购买者，所有者2是出售者。
- 在第三笔交易中，所有者2又变成了购买者，所有者3是出售者。

这就是“电子硬币是数字签名链”的含义。所有权通过一次又一次的签名，像链条一样清晰地传递下去。

> 4. 每一层的传递，是否都包含之前的所有交易信息，层层嵌套？

**不包含，这里不是“层层嵌套”的俄罗斯套娃结构，而更像是一个“环环相扣”的铁链。**

这是一个非常精妙的设计，解决了效率和存储空间的问题。如果每一笔新交易都必须打包之前所有的交易信息，那这个数据很快就会变得无比庞大，无法管理。

实际上，每一笔新交易**只需要包含一个指向前一笔交易的“指针”**，这个指针就是**上一笔交易的哈希值**。

- **交易2** 只需要说：“我花的是从**交易1**（由其哈希值代表）那里来的钱”。
- **交易3** 只需要说：“我花的是从**交易2**（由其哈希值代表）那里来的钱”。
- ...以此类推。

这样就形成了一条清晰、可追溯但又非常轻便的链条。你想验证一枚硬币的完整历史，只需要从最新的交易开始，根据哈希值一个一个地往前追溯，就像沿着铁链的链环往回找一样。你不需要在最后一个链环上扛着前面所有链环的实际重量。

1. **可追溯性 (Traceability)**：通过**哈希链**实现。每一笔交易都“指向”前一笔，形成一条不可分割的公开账本。这确保了**透明性** (Transparency) 和**防篡改性** (Immutability)。一旦记录上链，就很难更改，因为改动一个环节，后续的所有环节都会失效。
    
2. **可靠性 (Reliability)**：通过**数字签名**实现。每一笔交易都必须由当前所有者的私钥签名，而任何人都可以用其公钥来验证。这确保了**所有权的真实性** (Authenticity) 和**控制权** (Control)。只有真正的所有者才能花费他的硬币。

**正是这两个机制的精妙组合，确保了整个链条的安全与透明。** 任何人都可以在这条公开的链上，从任何一笔交易开始，追溯它的完整历史，并且在每一个环节上，都能用密码学来验证这笔交易确实是由合法的所有者发起的。

**思考一下这个场景：**

如果一个坏人（我们称他为攻击者）把一枚硬币支付给你，这笔交易（我们称之为交易A）被广播到了网络上。同时，他又偷偷地发起了另一笔交易（交易B），在这笔交易里，他把**同一枚硬币**又支付给了他自己的另一个地址。

交易A和交易B都是由他合法签名的，从“可靠性”上说都有效。他也都正确地指向了上一笔交易，从“可追溯性”上也都说的通。

那么，整个网络应该相信哪一笔交易是真的呢？如何防止这种“双重支付”（double-spending）攻击呢？

这就是比特币白皮书要解决的终极问题，也是我们接下来要讨论的、这个系统中最具革命性的部分：**工作证明 (Proof-of-Work)**。

## 工作证明（Proof-of-Work）

### 工作证明的定义

所谓的工作证明，就是去寻找一个数值，这个数值要满足以下条件：

为它提取散列数值之后（例如使用 SHA-256 计算散列数值），这**个散列数值必须以一定数量的 0 开头。**
每增加一个 0 的要求，将**使得工作量指数级增加**，并且，这个工作量的验证却只需通过计算一个哈希。

![[5. WIKI - 系统性知识/web3/assets/理解比特币白皮书/image-1.png]]

### 如何生动的理解工作证明


### 工作证明如何解决“双重支付”问题？